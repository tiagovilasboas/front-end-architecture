---
import { getCollection } from 'astro:content';
import BaseLayout from '../../components/layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const patterns = await getCollection('patterns');
  return patterns.map(pattern => ({
    params: { slug: pattern.slug },
    props: { pattern },
  }));
}

const { pattern } = Astro.props;
const { Content } = await pattern.render();
---
<BaseLayout title={pattern.data.name} description={pattern.data.description}>
  <article>
    <header class="hero-section">
      <h1 class="title">{pattern.data.name}</h1>
      <p class="subtitle">{pattern.data.description}</p>
    </header>
    <div class="prose">
      <Content />
    </div>
  </article>
</BaseLayout>

<style is:global>
  .hero-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 1rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: 2rem;
  }
  .title {
    font-size: 2.25rem;
    font-weight: 800;
  }
  .subtitle {
    max-width: 42rem;
    color: var(--muted-foreground);
    font-size: 1.125rem;
  }
  
  .prose {
    margin: 0 auto;
  }

  /* For√ßa o tema escuro para os diagramas Mermaid */
  .prose .mermaid {
    /* Cores do tema escuro (inspirado no Atom One Dark) */
    --mermaid-background: #282c34;
    --mermaid-main-bg: #282c34;
    --mermaid-text-color: #abb2bf;
    --mermaid-node-border: #61afef;
    --mermaid-primary-color: #353b45;
    --mermaid-primary-border-color: #61afef;
    --mermaid-primary-text-color: #e6e6e6;
    --mermaid-secondary-color: #2c313a;
    --mermaid-secondary-border-color: #c678dd;
    --mermaid-secondary-text-color: #e6e6e6;
    --mermaid-tertiary-color: #21252b;
    --mermaid-tertiary-border-color: #98c379;
    --mermaid-tertiary-text-color: #e6e6e6;
    --mermaid-line-color: #5c6370;
    --mermaid-cluster-bg: #21252b;
    --mermaid-cluster-border: #5c6370;

    /* Layout */
    display: flex;
    justify-content: center;
    background: transparent;
    padding: 1rem;
    margin-block: 2rem;
  }

  .prose .mermaid svg {
    background-color: var(--mermaid-main-bg) !important;
    border-radius: 0.5rem;
  }
  
  .prose h1,
  .prose h2 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-top: 2em;
    margin-bottom: 1em;
  }
  .prose p {
    line-height: 1.7;
    margin-bottom: 1em;
  }
  .prose a {
    color: var(--primary);
    text-decoration: underline;
  }
  .prose ul {
    list-style-type: disc;
    padding-left: 1.5em;
    margin-bottom: 1em;
  }
  .prose code {
    background-color: var(--secondary);
    padding: 0.2em 0.4em;
    border-radius: 0.3em;
    font-size: 0.9em;
  }
</style> 